#pragma once
#include <Windows.h>
#include "RAddies.h"

#include "lua.h"


#define setglobal(s, k) rlua_setfield(s, -10002, k);
#define getglobal(l,g)			 getfield(l, LUA_GLOBALSINDEX, g);
#define rlua_isnil(L,n)			     (Rlua::rlua_type(L, (n), TRUE) == 0)















void getService(std::string service)
{
	getfield(luaState, LUA_GLOBALSINDEX, "game");
	getfield(luaState, -1, "GetService");
	pushvalue(luaState, -2);
	pushstring(luaState, service.c_str());
	pcall(luaState, 2, 1, 0);
}



void ExecuteFunc(std::string cmd) {
	std::vector<std::string> st = gay(cmd, ' ');  //my sense of humor back then, "gay", "gay", "gay", The autism was real.
	if (st.size() != 0) {
		if (tostring(st.at(0)) == "ff") {
			if (tostring(st.at(1)) == "me" || tostring(st.at(1)) == "localplayer") {

				getglobal(luaState, "game");
				getfield(luaState, -1, "Players");
				getfield(luaState, -1, "LocalPlayer");
				getfield(luaState, -1, "Character");
				getglobal(luaState, "Instance");
				getfield(luaState, -1, "new");
				pushstring(luaState, "ForceField");
				pushvalue(luaState, -4);
				pcall(luaState, 2, 0, 0);

			}
			else {
				getglobal(luaState, "game");
				getfield(luaState, -1, "Players");
				getfield(luaState, -1, st.at(1).c_str());
				getfield(luaState, -1, "Character");
				getglobal(luaState, "Instance");
				getfield(luaState, -1, "new");
				pushstring(luaState, "ForceField");
				pushvalue(luaState, -4);
				pcall(luaState, 2, 0, 0);
			}
		}





		if (tostring(st.at(0)) == "cmds") { // cmd entered //no shit, past me
			cout << "ff [p] - gives a forcefield to the player" << endl;



		}
	}
}


	





//how to add cmds, SNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIPSNIP
//pure cringe i wouldnt want you to see that :(